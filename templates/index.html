<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ü§ñ Pacifica Trading Bot - Dashboard v1.1</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
</head>
<body class="bg-gray-900 text-white min-h-screen">
    <!-- Modal de Onboarding / Configura√ß√£o Inicial -->
    <div id="onboarding-modal" class="hidden fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-[9999]">
        <div class="bg-gray-800 rounded-2xl p-8 max-w-2xl w-full mx-4 shadow-2xl border border-gray-700">
            <!-- Header -->
            <div class="text-center mb-8">
                <div class="text-6xl mb-4">üîê</div>
                <h2 class="text-3xl font-bold mb-2">Configura√ß√£o Inicial</h2>
                <p class="text-gray-400">Configure suas credenciais de forma segura</p>
            </div>
            
            <!-- Wizard Steps -->
            <div class="flex justify-between mb-8">
                <div class="wizard-step active" data-step="1">
                    <div class="step-number">1</div>
                    <div class="step-label">Credenciais</div>
                </div>
                <div class="wizard-step-line"></div>
                <div class="wizard-step" data-step="2">
                    <div class="step-number">2</div>
                    <div class="step-label">Valida√ß√£o</div>
                </div>
                <div class="wizard-step-line"></div>
                <div class="wizard-step" data-step="3">
                    <div class="step-number">3</div>
                    <div class="step-label">Confirma√ß√£o</div>
                </div>
            </div>
            
            <!-- Step 1: Entrada de Credenciais -->
            <div id="onboarding-step-1" class="onboarding-step">
                <div class="space-y-6">
                    <div>
                        <label class="block text-gray-300 mb-2 font-medium">
                            üí≥ Endere√ßo da Carteira (P√∫blico)
                            <span class="text-red-400">*</span>
                        </label>
                        <input type="text" 
                               id="onboard-wallet-address"
                               placeholder="Ex: 7xKXtg2CW87d97TXJSDpbD5jBkheTqA83TZRuJosgAsU"
                               class="w-full bg-gray-700 text-white px-4 py-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 font-mono text-sm">
                        <p class="text-xs text-gray-400 mt-1">
                            ‚ÑπÔ∏è Seu endere√ßo p√∫blico da carteira Solana usado na Pacifica.fi
                        </p>
                    </div>
                    
                    <div>
                        <label class="block text-gray-300 mb-2 font-medium">
                            üîë Chave Privada da API
                            <span class="text-red-400">*</span>
                        </label>
                        <div class="relative">
                            <input type="password" 
                                   id="onboard-private-key"
                                   placeholder="Cole sua chave privada aqui"
                                   class="w-full bg-gray-700 text-white px-4 py-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 font-mono text-sm pr-12">
                            <button type="button" 
                                    onclick="togglePasswordVisibility('onboard-private-key')"
                                    class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-white">
                                üëÅÔ∏è
                            </button>
                        </div>
                        <p class="text-xs text-gray-400 mt-1">
                            üîí Esta chave ser√° criptografada com AES-256 antes de salvar
                        </p>
                    </div>
                    
                    <div>
                        <label class="block text-gray-300 mb-2 font-medium">
                            üåê Endere√ßo da API
                        </label>
                        <input type="text" 
                               id="onboard-api-address"
                               value="https://api.pacifica.fi/api/v1"
                               class="w-full bg-gray-700 text-white px-4 py-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm">
                    </div>
                    
                    <div class="bg-yellow-900/30 border border-yellow-600 rounded-lg p-4">
                        <div class="flex items-start gap-3">
                            <span class="text-2xl">‚ö†Ô∏è</span>
                            <div>
                                <p class="text-yellow-300 font-semibold mb-1">Importante:</p>
                                <ul class="text-sm text-yellow-100 space-y-1">
                                    <li>‚Ä¢ Suas credenciais ser√£o criptografadas localmente</li>
                                    <li>‚Ä¢ Ap√≥s salvar, a chave privada ser√° mascarada como ***</li>
                                    <li>‚Ä¢ Somente voc√™ ter√° acesso ao arquivo criptografado</li>
                                    <li>‚Ä¢ Nunca compartilhe sua chave privada</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="flex gap-3 mt-8">
                    <button onclick="hideOnboardingModal()" 
                            class="bg-gray-600 hover:bg-gray-700 px-6 py-3 rounded-lg font-semibold flex items-center justify-center gap-2">
                        ‚úï Cancelar
                    </button>
                    <button onclick="validateAndNextStep()" 
                            class="flex-1 bg-blue-600 hover:bg-blue-700 px-6 py-3 rounded-lg font-semibold flex items-center justify-center gap-2">
                        Validar Credenciais ‚Üí
                    </button>
                </div>
            </div>
            
            <!-- Step 2: Valida√ß√£o -->
            <div id="onboarding-step-2" class="onboarding-step hidden">
                <div class="text-center py-8">
                    <div class="animate-spin rounded-full h-16 w-16 border-b-2 border-blue-500 mx-auto mb-4"></div>
                    <p class="text-xl font-semibold mb-2">Validando credenciais...</p>
                    <p class="text-gray-400 text-sm" id="validation-status">Aguarde enquanto testamos a conex√£o</p>
                </div>
                
                <div id="validation-result" class="hidden mt-6"></div>
                
                <div class="flex gap-3 mt-8" id="validation-actions" style="display: none;">
                    <button onclick="hideOnboardingModal()" 
                            class="bg-red-600 hover:bg-red-700 px-4 py-3 rounded-lg font-semibold">
                        ‚úï Cancelar
                    </button>
                    <button onclick="goToStep(1)" 
                            class="flex-1 bg-gray-600 hover:bg-gray-700 px-6 py-3 rounded-lg font-semibold">
                        ‚Üê Voltar
                    </button>
                    <button onclick="saveCredentials()" 
                            class="flex-1 bg-green-600 hover:bg-green-700 px-6 py-3 rounded-lg font-semibold">
                        Salvar e Continuar ‚Üí
                    </button>
                </div>
            </div>
            
            <!-- Step 3: Confirma√ß√£o -->
            <div id="onboarding-step-3" class="onboarding-step hidden">
                <div class="text-center py-8">
                    <div class="text-6xl mb-4">‚úÖ</div>
                    <h3 class="text-2xl font-bold mb-2">Configura√ß√£o Conclu√≠da!</h3>
                    <p class="text-gray-400 mb-6">Suas credenciais foram salvas com seguran√ßa</p>
                    
                    <div class="bg-green-900/30 border border-green-600 rounded-lg p-6 text-left">
                        <div class="space-y-3 text-sm">
                            <div class="flex items-center gap-2">
                                <span class="text-green-400">‚úì</span>
                                <span>Credenciais criptografadas com AES-256</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <span class="text-green-400">‚úì</span>
                                <span>Conex√£o com API validada</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <span class="text-green-400">‚úì</span>
                                <span>Arquivo protegido com permiss√µes 600</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <span class="text-green-400">‚úì</span>
                                <span>Backup de seguran√ßa criado</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-blue-900/30 border border-blue-600 rounded-lg p-4 mt-6">
                        <p class="text-blue-300 text-sm">
                            üí° <strong>Pr√≥ximo passo:</strong> Configure sua estrat√©gia de trading
                        </p>
                    </div>
                </div>
                
                <button onclick="completeOnboarding()" 
                        class="w-full bg-blue-600 hover:bg-blue-700 px-6 py-3 rounded-lg font-semibold text-lg">
                    Come√ßar a Usar o Bot üöÄ
                </button>
            </div>
        </div>
    </div>

    <!-- Alertas Toast -->
    <div id="alerts-container"></div>
    
    <div class="container mx-auto p-4 max-w-7xl">
        <!-- Header -->
        <div class="mb-8 flex justify-between items-center">
            <div>
                <h1 class="text-4xl font-bold mb-2">ü§ñ Pacifica Trading Bot</h1>
                <p class="text-gray-400">Dashboard v1.1 - Configura√ß√µes R√°pidas + Auto-apply</p>
            </div>
            <div class="text-right">
                <div class="flex items-center gap-2 justify-end mb-2">
                    <span class="text-gray-400 text-sm">Auto-Refresh:</span>
                    <div id="refresh-status" class="flex items-center gap-2">
                        <span class="ws-connected">‚óè</span>
                        <span class="text-sm">Ativo (30s)</span>
                    </div>
                </div>
                <div class="text-sm text-gray-500" id="last-update">√öltima atualiza√ß√£o: -</div>
            </div>
        </div>

        <!-- Tabs -->
        <div class="flex gap-4 mb-6 border-b border-gray-700 overflow-x-auto">
            <button onclick="showTab('dashboard')" id="tab-dashboard" 
                    class="px-4 py-2 border-b-2 border-blue-500 text-blue-500 whitespace-nowrap">
                üìä Dashboard
            </button>
            <button onclick="showTab('volume')" id="tab-volume" 
                    class="px-4 py-2 text-gray-400 hover:text-white whitespace-nowrap">
                üí∞ Volume
            </button>
            <button onclick="showTab('trades')" id="tab-trades" 
                    class="px-4 py-2 text-gray-400 hover:text-white whitespace-nowrap">
                üìã Hist√≥rico
            </button>
            <button onclick="showTab('logs')" id="tab-logs" 
                    class="px-4 py-2 text-gray-400 hover:text-white whitespace-nowrap">
                üìú Logs
            </button>
            <button onclick="showTab('csv-analysis')" id="tab-csv-analysis" 
                    class="px-4 py-2 text-gray-400 hover:text-white whitespace-nowrap">
                üìä An√°lise CSV
            </button>
            <button onclick="showTab('config')" id="tab-config" 
                    class="px-4 py-2 text-gray-400 hover:text-white whitespace-nowrap">
                ‚öôÔ∏è Config
            </button>
            <button onclick="showTab('market-vision')" id="tab-market-vision" 
                    class="px-4 py-2 text-gray-400 hover:text-white whitespace-nowrap">
                üéØ Market Vision
            </button>
        </div>

        <!-- Dashboard Tab -->
        <div id="content-dashboard">
            <!-- Status Cards e Controles -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                <div class="bg-gray-800 rounded-lg p-6 metric-card">
                    <p class="text-gray-400 text-sm mb-2">Status</p>
                    <p id="status-text" class="text-2xl font-bold">üî¥ Parado</p>
                </div>
                <div class="bg-gray-800 rounded-lg p-6 metric-card">
                    <p class="text-gray-400 text-sm mb-2">PNL Acumulado</p>
                    <p id="pnl-text" class="text-2xl font-bold">$0.00</p>
                </div>
                <div class="bg-gray-800 rounded-lg p-6 metric-card">
                    <p class="text-gray-400 text-sm mb-2">Total Volume</p>
                    <p id="volume-text" class="text-2xl font-bold">$0</p>
                </div>
                <div class="bg-gray-800 rounded-lg p-6 metric-card">
                    <p class="text-gray-400 text-sm mb-2">Controles</p>
                    <div class="flex gap-2 flex-wrap justify-center mt-3">
                        <button id="btn-start" onclick="startBot()" 
                                class="bg-green-600 hover:bg-green-700 px-3 py-2 rounded text-sm font-semibold">
                            ‚ñ∂Ô∏è
                        </button>
                        <button id="btn-stop" onclick="stopBot(false)" disabled
                                class="bg-yellow-600 hover:bg-yellow-700 px-3 py-2 rounded text-sm font-semibold btn-disabled">
                            ‚è∏Ô∏è
                        </button>
                        <button id="btn-stop-force" onclick="stopBot(true)" disabled
                                class="bg-red-600 hover:bg-red-700 px-3 py-2 rounded text-sm font-semibold btn-disabled">
                            üõë
                        </button>
                        <button id="btn-restart" onclick="restartBot()" disabled
                                class="bg-blue-600 hover:bg-blue-700 px-3 py-2 rounded text-sm font-semibold btn-disabled">
                            üîÑ
                        </button>
                    </div>
                </div>
            </div>

            <!-- Resumo de Posi√ß√µes -->
            <div class="bg-gray-800 rounded-lg p-6 mb-6">
                <h2 class="text-xl font-semibold mb-4">üìä Resumo</h2>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                    <div>
                        <p class="text-gray-400 text-sm mb-2">PNL N√£o Realizado</p>
                        <p id="unrealized-pnl" class="text-2xl font-bold">$0.00</p>
                    </div>
                    <div>
                        <p class="text-gray-400 text-sm mb-2">PNL Realizado</p>
                        <p id="realized-pnl" class="text-2xl font-bold">$0.00</p>
                    </div>
                    <div>
                        <p class="text-gray-400 text-sm">Exposi√ß√£o Total</p>
                        <p id="positions-exposure" class="text-2xl font-bold">$0.00</p>
                    </div>
                    <div>
                        <p class="text-gray-400 text-sm">Ordens Pendentes</p>
                        <p id="orders-pending-value" class="text-2xl font-bold">$0.00</p>
                    </div>
                </div>
            </div>

            <!-- M√©tricas de Conta e Margem -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                <div class="bg-gray-800 rounded-lg p-6">
                    <h3 class="text-lg font-semibold mb-4">üí∞ Saldo da Conta</h3>
                    <div class="space-y-2">
                        <div class="flex justify-between">
                            <span class="text-gray-400">Saldo Total:</span>
                            <span id="account-balance" class="text-2xl font-bold text-blue-400">$0.00</span>
                        </div>
                        <div class="flex justify-between text-sm">
                            <span class="text-gray-500">√öltima atualiza√ß√£o:</span>
                            <span id="balance-updated" class="text-gray-500">-</span>
                        </div>
                    </div>
                </div>
                
                <div class="bg-gray-800 rounded-lg p-6">
                    <h3 class="text-lg font-semibold mb-4">üìä Margem</h3>
                    <div class="space-y-2">
                        <div class="flex justify-between">
                            <span class="text-gray-400">Margem Usada:</span>
                            <span id="margin-used" class="text-orange-400">$0.00</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-400">Margem Dispon√≠vel:</span>
                            <span id="margin-available" class="text-green-400">$0.00</span>
                        </div>
                    </div>
                </div>
                
                <div class="bg-gray-800 rounded-lg p-6">
                    <h3 class="text-lg font-semibold mb-4">üéØ Utiliza√ß√£o</h3>
                    <div class="space-y-3">
                        <div>
                            <div class="flex justify-between mb-1">
                                <span class="text-gray-400">Margem Livre:</span>
                                <span id="margin-free-percent" class="text-2xl font-bold text-green-400">0%</span>
                            </div>
                            <div class="w-full bg-gray-700 rounded-full h-2">
                                <div id="margin-free-bar" class="bg-green-500 h-2 rounded-full transition-all" style="width: 0%"></div>
                            </div>
                        </div>
                        <div class="text-xs text-gray-500 text-center">
                            <span id="margin-status-text">Monitorando...</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Posi√ß√µes e Ordens -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                <!-- Header com status de atualiza√ß√£o -->
                <div class="lg:col-span-2 text-center">
                    <div class="text-sm text-gray-400">
                        <span>√öltima atualiza√ß√£o: </span>
                        <span id="last-update-time" class="text-blue-400">Carregando...</span>
                        <span class="ml-4">Atualiza√ß√µes autom√°ticas a cada 5s</span>
                    </div>
                </div>
                
                <!-- Posi√ß√µes Ativas -->
                <div class="bg-gray-800 rounded-lg p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-xl font-semibold">üìà Posi√ß√µes Ativas</h2>
                        <div class="flex items-center gap-3">
                            <button onclick="loadPositionsAndOrders()" 
                                    class="bg-blue-600 hover:bg-blue-700 px-3 py-1 rounded text-sm flex items-center gap-1 transition-colors"
                                    title="Atualizar agora">
                                üîÑ Atualizar
                            </button>
                            <span id="positions-count" class="bg-blue-600 px-3 py-1 rounded text-sm">0</span>
                        </div>
                    </div>
                    <div id="positions-container" class="space-y-3">
                        <p class="text-gray-500 text-center py-8">Nenhuma posi√ß√£o ativa</p>
                    </div>
                </div>
                
                <!-- Ordens Abertas -->
                <div class="bg-gray-800 rounded-lg p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-xl font-semibold">üìã Ordens Abertas</h2>
                        <div class="flex items-center gap-3">
                            <button onclick="loadPositionsAndOrders()" 
                                    class="bg-blue-600 hover:bg-blue-700 px-3 py-1 rounded text-sm flex items-center gap-1 transition-colors"
                                    title="Atualizar agora">
                                üîÑ Atualizar
                            </button>
                            <div class="flex items-center gap-2 text-sm">
                                <span class="bg-green-600 px-2 py-1 rounded flex items-center gap-1">
                                    üü¢ <span id="buy-orders-count">0</span>
                                </span>
                                <span class="bg-red-600 px-2 py-1 rounded flex items-center gap-1">
                                    üî¥ <span id="sell-orders-count">0</span>
                                </span>
                            </div>
                            <span id="orders-count" class="bg-purple-600 px-3 py-1 rounded text-sm">0</span>
                        </div>
                    </div>
                    <div id="orders-container" class="space-y-3">
                        <p class="text-gray-500 text-center py-8">Nenhuma ordem aberta</p>
                    </div>
                </div>
            </div>

            <!-- DASHBOARD UNIFICADO DE GERENCIAMENTO DE RISCO -->
            <div id="risk-dashboard" class="p-4 bg-gray-900 text-white rounded-2xl shadow-lg mt-4">
              <h2 class="text-xl font-bold mb-4 flex items-center gap-2">
                üõ°Ô∏è Painel de Gerenciamento de Risco
                <span id="risk-status-indicator" class="text-sm font-semibold bg-green-500 px-2 py-1 rounded-lg text-black">Online</span>
              </h2>

              <div class="grid grid-cols-3 gap-4 text-sm font-mono">
                <!-- COLUNA 1: Configura√ß√µes -->
                <div class="bg-gray-800 p-3 rounded-xl">
                  <h3 class="text-blue-400 font-semibold mb-2">‚öôÔ∏è Configura√ß√µes Atuais</h3>
                  <p><strong>Ciclo Stop:</strong> <span id="cfg-cycle-sl">‚Äî</span>%</p>
                  <p><strong>Ciclo Take:</strong> <span id="cfg-cycle-tp">‚Äî</span>%</p>
                  <p><strong>Emerg√™ncia SL:</strong> <span id="cfg-emerg-sl">‚Äî</span>%</p>
                  <p><strong>Emerg√™ncia TP:</strong> <span id="cfg-emerg-tp">‚Äî</span>%</p>
                  <p><strong>Margem Alvo:</strong> <span id="cfg-margin">‚Äî</span>%</p>
                  <p><strong>Max Loss Sess√£o:</strong> $<span id="cfg-session-loss">‚Äî</span></p>
                  <p><strong>Meta Lucro Sess√£o:</strong> $<span id="cfg-session-profit">‚Äî</span></p>
                </div>

                <!-- COLUNA 2: Trade Atual -->
                <div class="bg-gray-800 p-3 rounded-xl">
                  <h3 class="text-green-400 font-semibold mb-2">üìä Trade Ativo</h3>
                  <p><strong>ID:</strong> <span id="trade-id">‚Äî</span></p>
                  <p><strong>Ativo:</strong> <span id="trade-symbol">‚Äî</span></p>
                  <p><strong>Tipo:</strong> <span id="trade-side">‚Äî</span></p>
                  <p><strong>Tempo em Trade:</strong> <span id="trade-time">‚Äî</span></p>
                  <p><strong>Pre√ßo Atual:</strong> $<span id="trade-price">‚Äî</span></p>
                  <p><strong>PNL:</strong> <span id="trade-pnl-usd">$0.00</span> (<span id="trade-pnl-pct">0.00%</span>)</p>
                  <p><strong>Status:</strong> <span id="trade-status">Nenhum trade ativo</span></p>
                </div>

                <!-- COLUNA 3: Sess√£o -->
                <div class="bg-gray-800 p-3 rounded-xl">
                  <h3 class="text-yellow-400 font-semibold mb-2">üìà Sess√£o / Sa√∫de</h3>
                  <p><strong>Ciclos:</strong> <span id="session-cycles">0</span></p>
                  <p><strong>PNL Acumulado:</strong> $<span id="session-pnl">0.00</span></p>
                  <p><strong>Margem Atual:</strong> <span id="session-margin">‚Äî</span>%</p>
                  <p><strong>√öltima Verifica√ß√£o:</strong> <span id="session-lastcheck">‚Äî</span></p>
                  <p><strong>Flags:</strong> <span id="session-flags">‚Äî</span></p>
                </div>
              </div>
            </div>

            <!-- System Info -->
            <div id="system-info" class="bg-gray-800 rounded-lg p-6 hidden">
                <h2 class="text-xl font-semibold mb-4">üíª Informa√ß√µes do Sistema</h2>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                    <div>
                        <p class="text-gray-400 text-sm">PID</p>
                        <p id="pid-text" class="text-xl font-mono">-</p>
                    </div>
                    <div>
                        <p class="text-gray-400 text-sm">CPU</p>
                        <p id="cpu-text" class="text-xl">0%</p>
                    </div>
                    <div>
                        <p class="text-gray-400 text-sm">Mem√≥ria</p>
                        <p id="memory-text" class="text-xl">0 MB</p>
                    </div>
                    <div>
                        <p class="text-gray-400 text-sm">Uptime</p>
                        <p id="uptime-text" class="text-xl">0m</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Trades Tab -->
        <div id="content-trades" class="hidden">
            <div class="bg-gray-800 rounded-lg p-6">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-semibold">üìã Hist√≥rico de Trades</h2>
                    <div class="flex gap-2">
                        <button onclick="exportCSV()" class="bg-green-600 hover:bg-green-700 px-4 py-2 rounded flex items-center gap-2">
                            üì• CSV
                        </button>
                        <button onclick="refreshTrades()" class="bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded">
                            üîÑ
                        </button>
                    </div>
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full text-sm">
                        <thead class="bg-gray-700">
                            <tr>
                                <th class="px-4 py-3 text-left">Data/Hora</th>
                                <th class="px-4 py-3 text-left">S√≠mbolo</th>
                                <th class="px-4 py-3 text-right">PNL USD</th>
                                <th class="px-4 py-3 text-right">PNL %</th>
                                <th class="px-4 py-3 text-right">Dura√ß√£o</th>
                                <th class="px-4 py-3 text-left">Motivo</th>
                                <th class="px-4 py-3 text-right">PNL Acum.</th>
                            </tr>
                        </thead>
                        <tbody id="trades-table-body" class="divide-y divide-gray-700">
                            <tr>
                                <td colspan="7" class="px-4 py-8 text-center text-gray-500">
                                    Carregando hist√≥rico...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="mt-4 text-center">
                    <button onclick="loadMoreTrades()" id="btn-load-more" 
                            class="bg-gray-700 hover:bg-gray-600 px-6 py-2 rounded">
                        Carregar Mais
                    </button>
                </div>
            </div>
        </div>

        <!-- Logs Tab (MELHORADO) -->
        <div id="content-logs" class="hidden">
            <div class="bg-gray-800 rounded-lg p-6">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-semibold">üìú Logs (Auto-refresh)</h2>
                    <div class="flex gap-2">
                        <button id="btn-pause-logs" onclick="toggleLogsPause()" 
                                class="bg-yellow-600 hover:bg-yellow-700 px-4 py-2 rounded flex items-center gap-2">
                            ‚è∏Ô∏è Pausar
                        </button>
                        <button onclick="refreshLogs()" class="bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded">
                            üîÑ Atualizar
                        </button>
                        <button onclick="clearLogsDisplay()" class="bg-gray-600 hover:bg-gray-700 px-4 py-2 rounded">
                            üóëÔ∏è Limpar
                        </button>
                    </div>
                </div>
                <div class="bg-yellow-500/10 border border-yellow-500 rounded-lg p-3 mb-4 flex items-center gap-2">
                    <span class="text-yellow-500">‚ö°</span>
                    <span class="text-sm text-yellow-200" id="logs-status">
                        Auto-refresh ativo (a cada 3s)
                    </span>
                </div>
                <div id="logs-container" class="bg-gray-900 rounded p-4 h-96 overflow-y-auto font-mono text-sm">
                    <p class="text-gray-500">Carregando logs...</p>
                </div>
            </div>
        </div>

        <!-- CSV Analysis Tab -->
        <div id="content-csv-analysis" class="hidden">
            <!-- Upload Section -->
            <div class="bg-gray-800 rounded-lg p-6 mb-6">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-semibold">üì§ Upload CSV da Pacifica</h2>
                    <button onclick="refreshCSVList()" class="bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded">
                        üîÑ Atualizar Lista
                    </button>
                </div>
                
                <!-- Upload Form -->
                <div class="border-2 border-dashed border-gray-600 rounded-lg p-8 text-center mb-6">
                    <input type="file" id="csv-file-input" accept=".csv" class="hidden" onchange="handleFileSelect(event)">
                    <button onclick="document.getElementById('csv-file-input').click()" 
                            class="bg-green-600 hover:bg-green-700 px-6 py-3 rounded-lg font-semibold mb-2">
                        üìÅ Selecionar CSV
                    </button>
                    <p class="text-gray-400 text-sm mt-2">Arraste um arquivo CSV aqui ou clique para selecionar</p>
                    <p class="text-gray-500 text-xs mt-1">Formato aceito: CSV exportado da Pacifica.fi (m√°x 16MB)</p>
                </div>
                
                <!-- Progress -->
                <div id="upload-progress" class="hidden">
                    <div class="bg-gray-700 rounded-full h-2 mb-2">
                        <div id="upload-progress-bar" class="bg-blue-600 h-2 rounded-full transition-all" style="width: 0%"></div>
                    </div>
                    <p id="upload-status" class="text-sm text-gray-400 text-center">Processando...</p>
                </div>
            </div>
            
            <!-- Available Files -->
            <div class="bg-gray-800 rounded-lg p-6 mb-6">
                <h2 class="text-xl font-semibold mb-4">üìÇ Arquivos Dispon√≠veis</h2>
                <div id="csv-files-list" class="space-y-2">
                    <p class="text-gray-500">Carregando...</p>
                </div>
            </div>
            
            <!-- Analysis Results -->
            <div id="csv-analysis-results" class="hidden">
                <!-- Summary Cards -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                    <div class="bg-gray-800 rounded-lg p-6">
                        <p class="text-gray-400 text-sm mb-2">Total de Trades</p>
                        <p id="csv-total-trades" class="text-3xl font-bold">-</p>
                    </div>
                    <div class="bg-gray-800 rounded-lg p-6">
                        <p class="text-gray-400 text-sm mb-2">Win Rate</p>
                        <p id="csv-win-rate" class="text-3xl font-bold">-</p>
                    </div>
                    <div class="bg-gray-800 rounded-lg p-6">
                        <p class="text-gray-400 text-sm mb-2">PNL Total</p>
                        <p id="csv-total-pnl" class="text-3xl font-bold">-</p>
                    </div>
                    <div class="bg-gray-800 rounded-lg p-6">
                        <p class="text-gray-400 text-sm mb-2">Profit Factor</p>
                        <p id="csv-profit-factor" class="text-3xl font-bold">-</p>
                    </div>
                </div>
                
                <!-- Detailed Stats -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                    <div class="bg-gray-800 rounded-lg p-6">
                        <h3 class="text-lg font-semibold mb-4">üìà Performance</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between">
                                <span class="text-gray-400">Trades Ganhos:</span>
                                <span id="csv-winning-trades" class="text-green-400 font-bold">-</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-400">Trades Perdidos:</span>
                                <span id="csv-losing-trades" class="text-red-400 font-bold">-</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-400">M√©dia por Trade:</span>
                                <span id="csv-avg-trade" class="font-bold">-</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-400">M√©dia de Ganho:</span>
                                <span id="csv-avg-win" class="text-green-400 font-bold">-</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-400">M√©dia de Perda:</span>
                                <span id="csv-avg-loss" class="text-red-400 font-bold">-</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-gray-800 rounded-lg p-6">
                        <h3 class="text-lg font-semibold mb-4">üí∞ Financeiro</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between">
                                <span class="text-gray-400">Volume Total:</span>
                                <span id="csv-total-volume" class="font-bold">-</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-400">Fees Totais:</span>
                                <span id="csv-total-fees" class="text-red-400 font-bold">-</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-400">Lucro L√≠quido:</span>
                                <span id="csv-net-profit" class="font-bold">-</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-400">Melhor Trade:</span>
                                <span id="csv-best-trade" class="text-green-400 font-bold">-</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-400">Pior Trade:</span>
                                <span id="csv-worst-trade" class="text-red-400 font-bold">-</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Charts -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                    <div class="bg-gray-800 rounded-lg p-6">
                        <h3 class="text-lg font-semibold mb-4">üìä Distribui√ß√£o de Resultados</h3>
                        <canvas id="csv-winrate-chart"></canvas>
                    </div>
                    
                    <div class="bg-gray-800 rounded-lg p-6">
                        <h3 class="text-lg font-semibold mb-4">üìà PNL Acumulado</h3>
                        <canvas id="csv-cumulative-pnl-chart"></canvas>
                    </div>
                </div>
                
                <!-- By Symbol -->
                <div class="bg-gray-800 rounded-lg p-6 mb-6">
                    <h3 class="text-lg font-semibold mb-4">üîç Performance por S√≠mbolo</h3>
                    <div id="csv-by-symbol" class="overflow-x-auto">
                        <table class="w-full">
                            <thead class="border-b border-gray-700">
                                <tr class="text-left text-gray-400 text-sm">
                                    <th class="pb-3">S√≠mbolo</th>
                                    <th class="pb-3">Trades</th>
                                    <th class="pb-3">Win Rate</th>
                                    <th class="pb-3">PNL</th>
                                    <th class="pb-3">Fees</th>
                                    <th class="pb-3">Volume</th>
                                </tr>
                            </thead>
                            <tbody id="csv-symbol-tbody" class="text-sm">
                                <!-- Populated by JS -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Daily Stats -->
                <div class="bg-gray-800 rounded-lg p-6">
                    <h3 class="text-lg font-semibold mb-4">üìÖ Performance Di√°ria</h3>
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead class="border-b border-gray-700">
                                <tr class="text-left text-gray-400 text-sm">
                                    <th class="pb-3">Data</th>
                                    <th class="pb-3">Trades</th>
                                    <th class="pb-3">Win Rate</th>
                                    <th class="pb-3">PNL</th>
                                    <th class="pb-3">Volume</th>
                                </tr>
                            </thead>
                            <tbody id="csv-daily-tbody" class="text-sm">
                                <!-- Populated by JS -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Config Tab v1.1 - MELHORADO -->
        <div id="content-config" class="hidden">
            <!-- Se√ß√£o de Gerenciamento de Credenciais -->
            <div id="credentials-manager" class="bg-gray-800 rounded-lg p-6 mb-6">
                <h3 class="text-xl font-semibold mb-4 flex items-center gap-2">
                    üîê Credenciais da API
                </h3>
                
                <!-- Credenciais Configuradas -->
                <div id="credentials-configured" style="display: none;">
                    <div class="space-y-4">
                        <div class="bg-gray-700 rounded-lg p-4">
                            <label class="block text-gray-400 text-sm mb-1">Endere√ßo da Carteira</label>
                            <div class="flex items-center gap-3">
                                <input type="text" 
                                       id="display-wallet-address" 
                                       readonly 
                                       class="flex-1 bg-gray-600 text-white px-4 py-2 rounded font-mono text-sm cursor-default">
                                <button onclick="copyToClipboard('display-wallet-address')" 
                                        class="bg-blue-600 hover:bg-blue-700 px-3 py-2 rounded text-sm">
                                    üìã Copiar
                                </button>
                            </div>
                        </div>
                        
                        <div class="bg-gray-700 rounded-lg p-4">
                            <label class="block text-gray-400 text-sm mb-1">Chave Privada da API</label>
                            <div class="flex items-center gap-3">
                                <input type="text" 
                                       id="display-private-key" 
                                       value="***CONFIGURADA***" 
                                       readonly 
                                       class="flex-1 bg-gray-600 text-gray-400 px-4 py-2 rounded font-mono text-sm cursor-not-allowed">
                                <button onclick="reconfigureCredentials()" 
                                        class="bg-yellow-600 hover:bg-yellow-700 px-4 py-2 rounded text-sm font-semibold">
                                    üîÑ Reconfigurar
                                </button>
                            </div>
                            <p class="text-xs text-gray-500 mt-2">
                                üîí Chave criptografada. Clique em "Reconfigurar" para alterar.
                            </p>
                        </div>
                        
                        <div class="bg-green-900/20 border border-green-600 rounded-lg p-3 flex items-center gap-2">
                            <span class="text-green-400 text-lg">‚úì</span>
                            <span class="text-green-300 text-sm">Credenciais configuradas e validadas</span>
                        </div>
                    </div>
                    
                    <div class="flex gap-3 mt-6">
                        <button onclick="testCredentialsConnection()" 
                                class="flex-1 bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded font-semibold">
                            üîå Testar Conex√£o
                        </button>
                        <button onclick="confirmDeleteCredentials()" 
                                class="bg-red-600 hover:bg-red-700 px-4 py-2 rounded font-semibold">
                            üóëÔ∏è Remover
                        </button>
                    </div>
                </div>
                
                <!-- Credenciais N√£o Configuradas -->
                <div id="credentials-not-configured">
                    <div class="text-center py-8">
                        <div class="text-6xl mb-4">üîì</div>
                        <p class="text-gray-400 mb-6">Nenhuma credencial configurada</p>
                        <button onclick="showOnboardingModal()" 
                                class="bg-blue-600 hover:bg-blue-700 px-6 py-3 rounded-lg font-semibold">
                            Configurar Credenciais
                        </button>
                    </div>
                </div>
            </div>

            <!-- Header com A√ß√µes -->
            <div class="bg-gray-800 rounded-lg p-6 mb-6">
                <div class="flex justify-between items-center mb-4">
                    <div>
                        <h2 class="text-xl font-semibold">‚öôÔ∏è Configura√ß√µes Avan√ßadas</h2>
                        <p class="text-gray-400 text-sm">Estrat√©gia Atual: <span id="config-current-strategy">Carregando...</span></p>
                    </div>
                    <div class="flex gap-3">
                        <button onclick="resetConfigForm()" 
                                class="bg-gray-600 hover:bg-gray-700 px-4 py-2 rounded">
                            ÔøΩ Resetar
                        </button>
                        <button onclick="previewConfigChanges()" 
                                class="bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded">
                            üëÅÔ∏è Preview
                        </button>
                        <button onclick="saveConfigV2()" 
                                class="bg-green-600 hover:bg-green-700 px-6 py-2 rounded font-semibold">
                            üíæ Salvar e Aplicar
                        </button>
                    </div>
                </div>
                
                <!-- Indicadores de Status -->
                <div class="grid grid-cols-3 gap-4 mt-4">
                    <div class="bg-gray-700 rounded p-3">
                        <div class="text-xs text-gray-400">√öltima Altera√ß√£o</div>
                        <div id="config-last-modified" class="text-sm text-white">--</div>
                    </div>
                    <div class="bg-gray-700 rounded p-3">
                        <div class="text-xs text-gray-400">Backups Dispon√≠veis</div>
                        <div id="config-backup-count" class="text-sm text-white">--</div>
                    </div>
                    <div class="bg-gray-700 rounded p-3">
                        <div class="text-xs text-gray-400">Status</div>
                        <div id="config-status" class="text-sm text-green-400">Pronto</div>
                    </div>
                </div>
            </div>



            <!-- Container Din√¢mico de Configura√ß√µes -->
            <div id="config-fields-container" class="space-y-6">
                <div class="bg-gray-700 rounded-lg p-8 text-center">
                    <div class="text-6xl mb-4">‚öôÔ∏è</div>
                    <p class="text-gray-400">Selecione uma estrat√©gia para configurar</p>
                </div>
            </div>

            <!-- Modal de Preview -->
            <div id="config-preview-modal" class="hidden fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50">
                <div class="bg-gray-800 rounded-lg p-6 max-w-3xl w-full mx-4 max-h-[80vh] overflow-y-auto">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-semibold">ÔøΩÔ∏è Preview de Mudan√ßas</h3>
                        <button onclick="closePreviewModal()" class="text-gray-400 hover:text-white text-2xl">&times;</button>
                    </div>
                    
                    <div id="config-preview-content" class="space-y-4">
                        <!-- Conte√∫do ser√° inserido dinamicamente -->
                    </div>
                    
                    <div class="flex gap-3 mt-6">
                        <button onclick="closePreviewModal()" 
                                class="bg-gray-600 hover:bg-gray-700 px-4 py-2 rounded">
                            ‚ùå Cancelar
                        </button>
                        <button onclick="confirmAndSaveConfig()" 
                                class="bg-green-600 hover:bg-green-700 px-6 py-2 rounded font-semibold">
                            ‚úÖ Confirmar e Salvar
                        </button>
                    </div>
                </div>
            </div>

            <!-- Modal de Backups -->
            <div id="config-backups-modal" class="hidden fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50">
                <div class="bg-gray-800 rounded-lg p-6 max-w-2xl w-full mx-4 max-h-[80vh] overflow-y-auto">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-semibold">ÔøΩ Backups Dispon√≠veis</h3>
                        <button onclick="closeBackupsModal()" class="text-gray-400 hover:text-white text-2xl">&times;</button>
                    </div>
                    
                    <div id="config-backups-list" class="space-y-2">
                        <!-- Lista ser√° inserida dinamicamente -->
                    </div>
                </div>
            </div>

            <!-- Se√ß√£o de Backups -->
            <div class="bg-gray-800 rounded-lg p-6 mt-6">
                <h3 class="text-lg font-semibold mb-4">üíæ Gerenciamento de Backups</h3>
                <p class="text-gray-400 text-sm mb-4">
                    Backups autom√°ticos s√£o criados antes de salvar. Restaure vers√µes anteriores se necess√°rio.
                </p>
                <button onclick="showBackupsModal()" 
                        class="bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded">
                    üìã Ver Backups Dispon√≠veis
                </button>
            </div>
        </div>

        <!-- Volume Tab -->
        <div id="content-volume" class="hidden">
            <!-- Cards de Volume por Per√≠odo -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
            <div class="bg-gray-800 rounded-lg p-4 metric-card">
                <div class="flex justify-between items-start mb-2">
                    <p class="text-gray-400 text-sm">√öltima Hora</p>
                    <span id="volume-1h-change" class="text-xs px-2 py-1 rounded bg-gray-700">-</span>
                </div>
                <p id="volume-1h" class="text-2xl font-bold text-blue-400">$0.00</p>
                <p class="text-gray-500 text-xs mt-1">
                    <span id="volume-1h-trades">0</span> trades
                </p>
            </div>
            
            <div class="bg-gray-800 rounded-lg p-4 metric-card">
                <div class="flex justify-between items-start mb-2">
                    <p class="text-gray-400 text-sm">√öltimas 24h</p>
                    <span id="volume-24h-change" class="text-xs px-2 py-1 rounded bg-gray-700">-</span>
                </div>
                <p id="volume-24h" class="text-2xl font-bold text-green-400">$0.00</p>
                <p class="text-gray-500 text-xs mt-1">
                    <span id="volume-24h-trades">0</span> trades
                </p>
            </div>
            
            <div class="bg-gray-800 rounded-lg p-4 metric-card">
                <div class="flex justify-between items-start mb-2">
                    <p class="text-gray-400 text-sm">√öltima Semana</p>
                    <span id="volume-7d-change" class="text-xs px-2 py-1 rounded bg-gray-700">-</span>
                </div>
                <p id="volume-7d" class="text-2xl font-bold text-purple-400">$0.00</p>
                <p class="text-gray-500 text-xs mt-1">
                    <span id="volume-7d-trades">0</span> trades
                </p>
            </div>
            
            <div class="bg-gray-800 rounded-lg p-4 metric-card">
                <div class="flex justify-between items-start mb-2">
                    <p class="text-gray-400 text-sm">√öltimos 14 dias</p>
                    <span id="volume-14d-change" class="text-xs px-2 py-1 rounded bg-gray-700">-</span>
                </div>
                <p id="volume-14d" class="text-2xl font-bold text-yellow-400">$0.00</p>
                <p class="text-gray-500 text-xs mt-1">
                    <span id="volume-14d-trades">0</span> trades
                </p>
            </div>
        </div>
        
        <!-- M√©tricas Detalhadas -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
            <div class="bg-gray-800 rounded-lg p-4">
                <h3 class="text-lg font-semibold mb-4">üíµ Financeiro (24h)</h3>
                <div class="space-y-3">
                    <div class="flex justify-between">
                        <span class="text-gray-400">Volume Total:</span>
                        <span id="volume-total-24h" class="font-bold">$0.00</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-gray-400">Fees Pagos:</span>
                        <span id="volume-fees-24h" class="text-red-400 font-bold">$0.00</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-gray-400">PNL Total:</span>
                        <span id="volume-pnl-24h" class="font-bold">$0.00</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-gray-400">Avg por Trade:</span>
                        <span id="volume-avg-24h" class="font-bold">$0.00</span>
                    </div>
                </div>
            </div>
            
            <div class="bg-gray-800 rounded-lg p-4">
                <h3 class="text-lg font-semibold mb-4">üìä Por S√≠mbolo (24h)</h3>
                <div id="volume-by-symbol" class="space-y-2 max-h-40 overflow-y-auto">
                    <p class="text-gray-500 text-sm">Carregando...</p>
                </div>
            </div>
            
            <div class="bg-gray-800 rounded-lg p-4">
                <h3 class="text-lg font-semibold mb-4">üîÑ Por Dire√ß√£o (24h)</h3>
                <div class="space-y-2">
                    <div class="flex justify-between items-center">
                        <span class="text-green-400">üü¢ Open Long:</span>
                        <span id="volume-open-long" class="font-bold">$0.00</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-red-400">üî¥ Open Short:</span>
                        <span id="volume-open-short" class="font-bold">$0.00</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-blue-400">üîµ Close Long:</span>
                        <span id="volume-close-long" class="font-bold">$0.00</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-yellow-400">üü° Close Short:</span>
                        <span id="volume-close-short" class="font-bold">$0.00</span>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Gr√°fico de Timeline -->
        <div class="bg-gray-800 rounded-lg p-4 mb-6">
            <div class="flex justify-between items-center mb-3">
                <h2 class="text-lg font-semibold">üìà Evolu√ß√£o do Volume</h2>
                <div class="flex gap-2">
                    <button onclick="loadVolumeTimeline(6, 60)" 
                            class="px-3 py-1 bg-gray-700 rounded text-sm hover:bg-gray-600">
                        6h
                    </button>
                    <button onclick="loadVolumeTimeline(24, 60)" 
                            class="px-3 py-1 bg-blue-600 rounded text-sm hover:bg-blue-700">
                        24h
                    </button>
                    <button onclick="loadVolumeTimeline(168, 360)" 
                            class="px-3 py-1 bg-gray-700 rounded text-sm hover:bg-gray-600">
                        7d
                    </button>
                    <button onclick="loadVolumeTimeline(336, 720)" 
                            class="px-3 py-1 bg-gray-700 rounded text-sm hover:bg-gray-600">
                        14d
                    </button>
                </div>
            </div>
            <div style="height: 300px; position: relative;">
                <canvas id="volume-timeline-chart"></canvas>
            </div>
        </div>
        
        <!-- Compara√ß√£o com Per√≠odo Anterior -->
        <div class="bg-gray-800 rounded-lg p-4">
            <h2 class="text-lg font-semibold mb-4">üìä Compara√ß√£o de Performance</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                    <h3 class="text-sm text-gray-400 mb-3">Per√≠odo Atual (24h)</h3>
                    <div class="space-y-2">
                        <div class="flex justify-between">
                            <span>Volume:</span>
                            <span id="comparison-current-volume" class="font-bold">$0.00</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Trades:</span>
                            <span id="comparison-current-trades" class="font-bold">0</span>
                        </div>
                        <div class="flex justify-between">
                            <span>PNL:</span>
                            <span id="comparison-current-pnl" class="font-bold">$0.00</span>
                        </div>
                    </div>
                </div>
                
                <div>
                    <h3 class="text-sm text-gray-400 mb-3">Per√≠odo Anterior (24h)</h3>
                    <div class="space-y-2">
                        <div class="flex justify-between">
                            <span>Volume:</span>
                            <span id="comparison-previous-volume" class="font-bold">$0.00</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Trades:</span>
                            <span id="comparison-previous-trades" class="font-bold">0</span>
                        </div>
                        <div class="flex justify-between">
                            <span>PNL:</span>
                            <span id="comparison-previous-pnl" class="font-bold">$0.00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="mt-4 pt-4 border-t border-gray-700">
                <div class="flex justify-between items-center">
                    <span class="text-gray-400">Varia√ß√£o:</span>
                    <div class="flex items-center gap-2">
                        <span id="comparison-change-absolute" class="font-bold">$0.00</span>
                        <span id="comparison-change-percent" class="px-3 py-1 rounded font-bold">0%</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Market Vision Tab -->
    <div id="content-market-vision" class="hidden">
        
        <!-- Header com Score Global -->
        <div class="mb-6 bg-gradient-to-r from-blue-900 to-purple-900 rounded-2xl p-6">
            <div class="text-center">
                <h2 class="text-3xl font-bold mb-2">üéØ AN√ÅLISE DE MERCADO</h2>
                <div class="flex items-center justify-center gap-4 mb-4">
                    <span class="text-6xl font-bold" id="mv-global-score">-</span>
                    <span class="text-2xl">/10</span>
                </div>
                <div class="w-full bg-gray-700 rounded-full h-4 mb-4">
                    <div id="mv-score-bar" class="bg-green-500 h-4 rounded-full transition-all" style="width: 0%"></div>
                </div>
                <div id="mv-global-status" class="text-2xl font-bold">
                    Carregando...
                </div>
            </div>
        </div>
        
        <!-- Grid de Scores -->
        <div class="grid grid-cols-5 gap-4 mb-6">
            <div class="bg-gray-800 rounded-xl p-4 text-center">
                <div class="text-sm text-gray-400 mb-2">üìà T√©cnico</div>
                <div class="text-3xl font-bold" id="mv-tech-score">-</div>
                <div class="text-xs mt-2">
                    <div id="mv-tech-rsi">RSI: -</div>
                    <div id="mv-tech-adx">ADX: -</div>
                </div>
            </div>
            
            <div class="bg-gray-800 rounded-xl p-4 text-center">
                <div class="text-sm text-gray-400 mb-2">üí∞ Volume</div>
                <div class="text-3xl font-bold" id="mv-vol-score">-</div>
                <div class="text-xs mt-2">
                    <div id="mv-vol-ratio">Ratio: -</div>
                    <div id="mv-vol-delta">Delta: -</div>
                </div>
            </div>
            
            <div class="bg-gray-800 rounded-xl p-4 text-center">
                <div class="text-sm text-gray-400 mb-2">üß† Sentimento</div>
                <div class="text-3xl font-bold" id="mv-sent-score">-</div>
                <div class="text-xs mt-2">
                    <div id="mv-sent-funding">Funding: -</div>
                    <div id="mv-sent-oi">OI: -</div>
                </div>
            </div>
            
            <div class="bg-gray-800 rounded-xl p-4 text-center">
                <div class="text-sm text-gray-400 mb-2">üéØ Estrutura</div>
                <div class="text-3xl font-bold" id="mv-struct-score">-</div>
            </div>
            
            <div class="bg-gray-800 rounded-xl p-4 text-center">
                <div class="text-sm text-gray-400 mb-2">üõ°Ô∏è Risco</div>
                <div class="text-3xl font-bold" id="mv-risk-score">-</div>
            </div>
        </div>
        
        <!-- Painel de Setup -->
        <div id="mv-setup-panel" class="bg-gradient-to-br from-green-900 to-blue-900 rounded-xl p-6 mb-6 hidden">
            <h3 class="text-2xl font-bold mb-4">üí° SETUP SUGERIDO</h3>
            
            <div class="grid grid-cols-2 gap-6">
                <div>
                    <div class="mb-4">
                        <span class="text-gray-400">Dire√ß√£o:</span>
                        <span id="mv-setup-direction" class="text-2xl font-bold ml-2">-</span>
                        <span id="mv-setup-confidence" class="ml-3 text-sm bg-green-600 px-2 py-1 rounded">
                            Confian√ßa: -%
                        </span>
                    </div>
                    
                    <div class="space-y-2 text-sm mb-4">
                        <div class="flex justify-between">
                            <span class="text-gray-400">Entry:</span>
                            <span id="mv-setup-entry" class="font-bold">-</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-400">Stop Loss:</span>
                            <span id="mv-setup-sl" class="font-bold text-red-400">-</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-400">Take Profit:</span>
                            <span id="mv-setup-tp" class="font-bold text-green-400">-</span>
                        </div>
                        <div class="flex justify-between border-t border-gray-700 pt-2">
                            <span class="text-gray-400">Position Size:</span>
                            <span id="mv-setup-size" class="font-bold">-</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-400">Risk/Reward:</span>
                            <span id="mv-setup-rr" class="font-bold text-green-400">-</span>
                        </div>
                    </div>
                    
                    <div class="bg-gray-800 rounded p-3 text-xs">
                        <div class="font-semibold mb-2">Condi√ß√µes atendidas:</div>
                        <div id="mv-setup-reasoning"></div>
                    </div>
                </div>
                
                <div>
                    <h4 class="font-semibold mb-3">üìä Multi-Timeframe</h4>
                    <div id="mv-mtf-summary" class="space-y-3"></div>
                </div>
            </div>
            
            <!-- Bot√µes de A√ß√£o -->
            <div class="grid grid-cols-3 gap-4 mt-6">
                <button class="bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-lg"
                        onclick="executeMarketVisionTrade()">
                    ‚úÖ Executar Trade
                </button>
                <button class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg"
                        onclick="skipMarketVisionSetup()">
                    ‚è≠Ô∏è Pular Setup
                </button>
                <button class="bg-purple-600 hover:bg-purple-700 text-white font-bold py-3 px-6 rounded-lg"
                        onclick="modifyMarketVisionSetup()">
                    ‚úèÔ∏è Modificar
                </button>
            </div>
        </div>
        
        <!-- Warnings -->
        <div id="mv-warnings" class="space-y-2"></div>
        
    </div>
    
    </div>  <!-- Fecha o container principal mx-auto p-4 max-w-7xl -->

    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>

